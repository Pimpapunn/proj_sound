<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
        integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .custom-select {
            width: 100%;
            /* หรือกำหนดขนาดตามต้องการ เช่น 300px */
        }
    </style>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <nav>
        <div class="container">
            <div class="nav-wrapper">
                <div class="logo">
                    <h3>My website</h3>
                </div>

                <ul class="menu" id="myMenu">
                    <li><a href="#"
                            onclick="window.location.href='https://geodev.fun/sss/soundwave/home/#'; return false;">Home</a>
                    </li>
                    <li><a href="#"
                            onclick="window.location.href='https://geodev.fun/sss/soundwave/about/#'; return false;">About</a>
                    </li>
                    <li><a href="#"
                            onclick="window.location.href='https://geodev.fun/sss/soundwave/contact/#'; return false;">Contact</a>
                    </li>
                </ul>
                <div class="ham-menu" onclick="toggleHam(this)">
                    <div class="bar1"></div>
                    <div class="bar2"></div>
                    <div class="bar3"></div>
                </div>
            </div>
        </div>
    </nav>
    <div class="container mt-5">
        <div class="row">
            <div class="col-sm-8">
                <div class="card" id="map">

                </div>
            </div>
            <div class="col-sm-4">
                <div class="card">
                    <div class="card-body">
                        <h3>Select During Time</h3>
                        <form>
                            <!-- Dropdown สำหรับ "Select During Time" -->
                            <div class="mb-3">
                                <select class="form-select w-100" aria-label="Select Day">
                                    <option selected>Open this select menu</option>
                                    <option value="1">Monday</option>
                                    <option value="2">Tuesday</option>
                                    <option value="3">Wednesday</option>
                                    <option value="4">Thursday</option>
                                    <option value="5">Friday</option>
                                    <option value="6">Saturday</option>
                                    <option value="7">Sunday</option>
                                </select>
                            </div>
                            <!-- Dropdown สำหรับ "Time" -->
                            <div class="mb-3">
                                <h3>Time</h3>
                                <select class="form-select w-100" aria-label="Select Time">
                                    <option selected>Open this select menu</option>
                                    <option value="1">8.00-9.00</option>
                                    <option value="2">9.00-10.00</option>
                                    <option value="3">10.00-11.00</option>
                                    <option value="4">11.00-12.00</option>
                                    <option value="5">12.00-13.00</option>
                                    <option value="6">13.00-14.00</option>
                                    <option value="7">14.00-15.00</option>
                                    <option value="8">15.00-16.00</option>
                                    <option value="9">16.00-17.00</option>
                                </select>
                            </div>
                            <!-- <div class="mb-3">
                                <h3>Position</h3>
                                <select class="form-select w-100" aria-label="Select Time">
                                    <option selected>Open this select menu</option>
                                    <option value="1">01</option>
                                    <option value="2">02</option>
                                    <option value="3">03</option>
                                    <option value="4">04</option>
                                    <option value="5">05</option>
                                    <option value="6">06</option>
                                    <option value="7">07</option>
                                    <option value="8">08</option>
                                    <option value="9">09</option>
                                    <option value="9">10</option>

                                </select>
                            </div> -->
                            <!-- ปุ่มประมวลผล -->
                            <div class="text-center">
                                <button type="submit" class="btn btn-primary">Submit</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
    </div>
</body>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
    crossorigin="anonymous"></script>
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>

<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
<script src="app.js"></script>
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script src="https://unpkg.com/geotiff/dist/geotiff.browser.min.js"></script>

<script>
    const map = L.map('map').setView([0, 0], 2);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
    }).addTo(map);

    async function loadGeoTIFF() {
        const day = document.getElementById('daySelect').value;
        const time = document.getElementById('timeSelect').value;

        if (!day || !time) {
            document.getElementById('result').innerHTML = "<p class='text-danger'>Please select both day and time.</p>";
            return;
        }

        // สมมติว่า URL ของไฟล์ GeoTIFF จะถูกกำหนดตามวันและเวลา เช่น 'path/to/your/geotiff/1.tif'
        // สำหรับตัวอย่างนี้เราจะใช้ชื่อไฟล์เป็น '1.tif'
        const url = `path/to/your/geotiff/${day}_${time}.tif`;

        try {
            const response = await fetch(url);
            if (!response.ok) {
                throw new Error('Network response was not ok.');
            }
            const arrayBuffer = await response.arrayBuffer();
            const tiff = await GeoTIFF.fromArrayBuffer(arrayBuffer);
            const image = await tiff.getImage();

            const data = await image.readRasters();
            const width = image.getWidth();
            const height = image.getHeight();

            // สร้างแผนที่ Leaflet และแสดงภาพ
            const canvas = document.createElement('canvas');
            canvas.width = width;
            canvas.height = height;
            const ctx = canvas.getContext('2d');
            const imageData = ctx.createImageData(width, height);
            const values = data[0]; // สมมติว่ามีแค่แบนด์เดียว
            for (let i = 0; i < values.length; i++) {
                const value = values[i];
                imageData.data[i * 4 + 0] = value; // Red
                imageData.data[i * 4 + 1] = value; // Green
                imageData.data[i * 4 + 2] = value; // Blue
                imageData.data[i * 4 + 3] = 255; // Alpha
            }
            ctx.putImageData(imageData, 0, 0);

            const base64Image = canvas.toDataURL();
            L.imageOverlay(base64Image, [[0, 0], [height, width]]).addTo(map);

            // ปรับการมองแผนที่ตามขนาดของภาพ
            map.setView([height / 2, width / 2], 1);

            document.getElementById('result').innerHTML = "<p>GeoTIFF data loaded successfully.</p>";
        } catch (error) {
            document.getElementById('result').innerHTML = `<p class='text-danger'>Error loading GeoTIFF: ${error.message}</p>`;
        }
    }
</script>

</html>